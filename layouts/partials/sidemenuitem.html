{{- $currentPage := .currentPage -}}
{{- $currentMenuItem := .ctx -}}
{{- $currentMenu := .menu -}}
{{- $oasData := "" -}}
{{- with .oasData -}}
  {{- $oasData = getJSON . -}}
{{- end -}}

{{- $target := "" -}}
{{- $iconEx := "" -}}
{{- with $currentMenuItem.Params.blank -}}
  {{- $target = . -}}
  {{- $iconEx = "<span data-mybicon='mybicon-external-link' data-mybicon-class='mls dev-sidemenu__icon' data-mybicon-width='14' data-mybicon-height='14'></span>" -}}
{{- end -}}
{{ .Params }}

<li
class="dev-sidemenu__level1 {{ if $currentPage.IsMenuCurrent $currentMenu $currentMenuItem }}active{{ end }}"
>
  <a href="{{ .url }}" class="dev-sidemenu__apititle" {{ $target | safeHTMLAttr }}>{{ .pageTitle }}{{ safeHTML $iconEx }}</a>
  {{- if $currentPage.IsMenuCurrent $currentMenu $currentMenuItem -}}
    <ul class="dev-sidemenu__sublist">
      {{- range $currentPage.Params.documentation -}}
        {{- with .title -}}
          <li>
            <a href="#{{ . | urlize }}">
              <span data-hover="{{ . }}">{{ . }}</span>
            </a>
          </li>
        {{- end -}}
      {{- end -}}

      {{- with or (index .apiData .identifier) $oasData -}}
        <li>
          <a href="#endpoints">
            <span data-hover="endpoints">Endpoints</span>
          </a>
        </li>
      {{- end -}}

      {{- with (index .apiData .identifier) -}}
        {{- range .resources -}}
          <li>
            <a href="#{{ .displayName | urlize }}">
              <span data-hover="{{ .displayName }}">
                {{- .displayName -}}
              </span>
            </a>
          </li>
        {{- end -}}
      {{- end -}}

      {{- with $oasData -}}
        {{- range .paths -}}
          {{- range . -}}
            <li>
              <a href="#{{ .summary | anchorize }}">
                <span data-hover="{{ .summary }}">
                  {{- .summary -}}
                </span>
              </a>
            </li>
          {{- end -}}
        {{- end -}}
      {{- end -}}

      {{- if and (eq (getenv "HUGO_ENV") "production") (isset $currentPage.Params "disqus_identifier") -}}
        <li>
          <a href="#api-support">
            API support
          </a>
        </li>
      {{- end -}}

    </ul>
  {{- end -}}
</li>
