{{- $hasExamples := false -}}
{{- range .responses -}}
  {{- range . -}}
    {{- if reflect.IsMap . -}}
      {{- range . -}}
        {{- if isset . "examples" -}}
          {{- $hasExamples = true -}}
        {{- end -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}
{{- if $hasExamples -}}
  {{- $response := .response -}}
  {{- $endpointId := .endpointId -}}

  <h3>Response examples</h3>
  {{- $resInd := 0 -}}
  <div class="bg-gray3 rad-t2px mts sticky-6r" id="{{$endpointId}}-response">
    {{- partial "api/oas/responsecode-btns.html" (dict "responses" .responses "endpointId" $endpointId) -}}
    {{- range $response, $_ := .responses -}}
      {{- with .content -}}
        {{- $responseId := print $endpointId "-" $response -}}
        <div class="relative bg-gray4 example-wrap" data-example="{{$responseId}}" role="tabpanel" aria-labelledby="{{$responseId}}" {{if ne $resInd 0}}hidden{{end}}>

          {{ $showFormatMenu := 0 }}
          {{ range $application, $_ := . }}
            {{ if or (in $application "json") (in $application "xml") }}
              {{ $showFormatMenu = add $showFormatMenu 1 }}
            {{ end }}
          {{ end }}
          {{ if gt $showFormatMenu 1 }}
            <div class="phm ptm">
              <select class="form__control w100p mb0 pas schema-type-select" name="formats" data-example-sub aria-label="Select format">
                {{ range $application, $_ := . }}
                    <option value="{{$application}}">{{$application}}</option>
                {{ end }}
              </select>
            </div>
          {{ end }}

          {{- range $application, $_ := . -}}
            {{- $format := "" -}}
            {{- if in $application "json" -}}
              {{- $format = "json" -}}
            {{- else if in $application "xml" -}}
              {{- $format = printf "xml" -}}
            {{- end -}}

            {{- if or (in $application "json") (in $application "xml") -}}
              {{- if isset . "examples" -}}
                {{- if gt (len .examples) 1 -}}
                  <div class="phm ptm">
                    <select class="form__control w100p mb0 pas schema-type-select" name="{{$responseId}}-{{$format}}" data-example-sub aria-label="Response code {{$response}} {{$format}} example">
                      {{- range $name, $val := .examples -}}
                        {{- with $val.description -}}
                          {{- $name = . -}}
                        {{- end -}}
                        {{- $exId := print $responseId "-" $name -}}
                        <option value="{{ $exId }}">{{ $name }}</option>
                      {{- end -}}
                    </select>
                  </div>
                {{- end -}}

                {{- $exInd := 0 -}}

                {{- range $name, $val := .examples -}}
                  {{- with $val.description -}}
                    {{- $name = . -}}
                  {{- end -}}
                  {{- $exId := print $responseId "-" $name -}}
                  <div class="relative mtm" data-example-sub="{{$exId}}" data-format="{{$application}}" {{if ne $exInd 0}}hidden{{end}}>
                    {{- partial (printf "api/oas/example-%s.html" $format) . -}}
                  </div>
                  {{- $exInd = add $exInd 1 -}}
                {{- end -}}

              {{- end -}}
            {{- end -}}
          {{- end -}}
        </div>
        {{- $resInd = add $resInd 1 -}}
      {{- end -}}
    {{- end -}}
  </div>
{{- end -}}
