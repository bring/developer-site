{{ $schemas := .schemas }}
{{ $schemaPath := path.Split .ctx }}
{{ $schemaRef := $schemaPath.File }}
{{ $nested := .nested }}

{{ range $schemas }}
    {{ $responseSchema := index . $schemaRef }}
    {{ range $key, $_ := $responseSchema }}
      {{ if reflect.IsMap . }}
        {{ range $param, $_ := . }}
          {{ if eq $nested true }}
            <div class="flex">
          {{ else }}
            <dl>
          {{ end }}
            <dt class="mb-border bb">
              {{ $param }}
            </dt>
            <dd class="flex-1 mb-border bb">
              {{ if eq $nested false }}
                <dl>
              {{ end }}
              {{ if reflect.IsMap . }}
                {{ range $i, $_ := . }}
                  {{ if reflect.IsMap . }}
                    {{ range $j, $_ := . }}
                      {{ if eq $j "$ref" }}
                        {{- partial "api/schema.html" (dict "ctx" . "schemas" $schemas "nested" true ) -}}
                      {{ end }}
                    {{ end }}
                  {{ else if reflect.IsSlice . }}
                    Enum:
                    <div>
                      {{ range . }}
                        <code>{{ . }}</code><br>
                      {{ end }}
                    </div>
                  {{ else }}
                    {{ if eq $i "$ref" }}
                      {{- partial "api/schema.html" (dict "ctx" . "schemas" $schemas "nested" true ) -}}
                    {{ else }}
                      {{ . }}
                    {{ end }}
                  {{ end }}
                {{ end }}
              {{ else }}
                {{ . }}<br>
              {{ end }}
              {{ if eq $nested false }}
                </dl>
              {{ end }}
            </dd>
          {{ if eq $nested true }}
            </div>
          {{ else }}
            </dl>
          {{ end }}
        {{ end }}

      {{ else if reflect.IsSlice . }}
        <div class="flex">
          <dt class="flex-1 mb-border bb">
            {{ $key }}
          </dt>
          <dd class="flex-1 mb-border bb">
            {{ range . }}
              - {{ . }} <br>
            {{ end }}
          </dd>
        </div>

      {{ else }}
      <div class="flex">
        <dt class="flex-1 mb-border bb">
          {{ $key }}
        </dt>
        <dd class="flex-1 mb-border bb">
          {{ . }}
        </dd>
      </div>
      {{ end }}
    {{ end }}

{{ end }}
