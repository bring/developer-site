{{ $schemas := .schemas }}
{{ $schemaPath := path.Split .ctx }}
{{ $schemaRef := $schemaPath.File }}
{{ $nested := .nested }}
{{ $required := "" }}

{{ range $schemas }}
    {{ $responseSchema := index . $schemaRef }}
    {{ range $key, $_ := $responseSchema }}
      {{ if reflect.IsMap . }}
        
        {{ $type := "" }} 
        {{ range $param, $_ := . }}
          {{ if reflect.IsMap $_ }}
            {{ range $k, $v := . }}
              {{ if eq $v "array"}}
                {{ $type = $v }}
              {{ end }}
            {{ end }}
          {{ end }}

          {{ if eq $nested true }}
            <div>
              <dl class="desc-list mb-border bb">
                <dt>
                  {{ $param }} 
                </dt>
          {{ else }}
            {{ if eq $type "array" }}
              <dl>
                <dt>
                  <dl class="desc-list bg-gray2 pam">
                    <dt>{{ $param }} </dt>
                    <dd><span class="error">Type: {{ $type }}</span></dd>
                </dt>
            {{ else }}
              <dl class="desc-list mb-border bb">
                <dt>
                  {{ $param }} 
                </dt>
            {{ end }}
            
          {{ end }}
            
            <dd>
            {{ if eq $nested false }}
              <dl class="desc-list">
            {{ end }}
            {{ if reflect.IsMap . }}
              {{ range $i, $_ := . }}
                {{ if reflect.IsMap . }}
                  {{ range $j, $_ := . }}
                    {{ if eq $j "$ref" }}
                      {{- partial "api/schema.html" (dict "ctx" . "schemas" $schemas "nested" true ) -}}
                    {{ end }}
                  {{ end }}
                {{ else if reflect.IsSlice . }}
                  Enum:
                  <div>
                    {{ range . }}
                      <code>{{ . }}</code><br>
                    {{ end }}
                  </div>
                {{ else }}
                  {{ $typeClass := "" }}
                  {{ if eq $i "$ref" }}
                    {{- partial "api/schema.html" (dict "ctx" . "schemas" $schemas "nested" true ) -}}
                  {{ else }}
                    {{ if eq . "int32" "integer" "string" "boolean" }}
                      {{ $typeClass = "mb-badge" }}
                      <div><span class="{{$typeClass}}">{{ . }}</span></div>
                    {{ end }}
                  {{ end }}
                {{ end }}
              {{ end }}
            {{ end }}
            {{ if eq $nested false }}
              </dl>
            {{ end }}
            </dd>
          {{ if eq $nested true }}
            </div>
          {{ else }}
            </dl>
          {{ end }}
        {{ end }}

      {{ else if reflect.IsSlice . }}
      <div class="error mtm">SLICE</div>
        <dl class="desc-list mb-border bb">
          <dt>
            {{ $key }}
          </dt>
          <dd>
            {{ range . }}
              - {{ . }} <br>
            {{ end }}
          </dd>
        </dl>

      {{ else }}
      <div class="error mtm">DEFAULT</div>
      <dl class="desc-list mb-border bb">
        <dt>
          {{ $key }}
        </dt>
        <dd>
          {{ . }} <br>
        </dd>
      </dl>
      {{ end }}
    {{ end }}

{{ end }}
