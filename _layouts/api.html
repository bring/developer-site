---
layout: redesign
---
<article class="api {{ page.api.title | remove:'API' | slugify }}">

  <header class="banner">
    <div class="overlay">
      <h1>{{ page.api.title }}</h1>
    </div>
  </header>

  <div class="page-body">
    <div class="page-content-container">

      <div class="container">
        <div class="gridline">
          <div class="col-3-4">
            <section id="api-documentation">
              {% for chapter in page.api.documentation %}
              <h2 class="anchored">{{ chapter.title }}</h2>
              {{ chapter.content | markdownify }}
              {% endfor %}
            </section>
            <section>
              <h2 class="large anchored">Overview of endpoints</h2>

              <h3>Base URL</h3>
              <pre>{{ page.api.base_uri }}</pre>

              <table class="linked-rows">
                <thead>
                  <th>Method</th>
                  <th>Endpoint</th>
                  <th>Usage</th>
                </thead>
                {% for resource in page.api.resources %}
                  {% for method in resource.methods %}
                    <tr>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ method[1].method }}</a></td>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ resource.relative_uri }}</a></td>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ method[1].description }}</a></td>
                    </tr>
                  {% endfor %}
                {% endfor %}
              </table>
            </section>


            {% for resource in page.api.resources %}

              {% if resource.uri_parameters contains 'mediaTypeExtension' %}
                {% for extension in resource.uri_parameters.mediaTypeExtension.enum %}
                  {% assign absolute_extension = resource.absolute_uri | replace:'{mediaTypeExtension}',extension %}
                  {% assign relative_extension = resource.relative_uri | replace:'{mediaTypeExtension}',extension %}
                  {% unless forloop.first %}
                    {% assign absoluteUriTitle = absoluteUriTitle | append: '<br/>'  %}
                    {% assign relativeUriTitle = relativeUriTitle | append: ' or '  %}
                  {% endunless %}
                  {% assign absoluteUriTitle = absoluteUriTitle | append: absolute_extension  %}
                  {% assign relativeUriTitle = relativeUriTitle | append: relative_extension  %}
                {% endfor %}
              {% else %}
                {% assign absoluteUriTitle = resource.absolute_uri %}
                {% assign relativeUriTitle = resource.relative_uri %}
              {% endif %}

              {% for method in resource.methods %}
              <section class="component {% cycle 'white', 'lightgrey' %}">

                <h2 class="large anchored" id="{{ resource.display_name | slugify }}">{{ resource.display_name }}</h2>

                {% if resource.description %}
                {{ resource.description | markdownify }}
                {% endif %}

                <h3>URL</h3>
                <pre>{{ absoluteUriTitle }}</pre>

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all URI parameters
                --
                ----------------------------------------
                {% endcomment %}
                {% if resource.uri_parameters.size > 0 %}
                  {% assign include_params = resource.uri_parameters %}
                  {% include named_params.html title="URI parameter" params=include_params %}
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all query parameters
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].query_parameters.size > 0 %}
                  {% assign include_params = method[1].query_parameters %}
                  {% include named_params.html title="Query parameter" params=include_params %}
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all headers
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].headers.size > 0 %}
                  <h3>Headers</h3>
                  <table>
                    <thead>
                      <th>Header name</th>
                      <th>Type</th>
                      <th>Required?</th>
                      <th>Description</th>
                    </thead>
                  {% for qh in method[1].headers %}
                    <tr>
                      <td><code>{{ qh[1].name }}</code></td>
                      <td><code>{{ qh[1].type }}<code></td>
                      <td>
                        {% if qh[1].required %}
                        Yes
                        {% else %}
                        No {% if qh[1].default %} (default: {{ qh[1].default }}){% endif %}
                        {% endif %}
                      </td>
                      <td>{{ qh[1].description }}</td>
                    </tr>
                  {% endfor %}
                  </table>
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- Request
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].bodies.size > 0 %}
                  <h3>Request body</h3>
                  {% comment %}

                  Tabs for JSON, XML, SOAP

                  {% endcomment %}
                  <ul class="tabs" role="tablist">
                  {% for body in method[1].bodies %}
                    {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                    {% assign tab_id =  method[1].method | append: '_' | append: resource.display_name | append: '_' | append: mt_display_name | slugify %}
                    <li role="presentation"{% if forloop.first %} class="active"{% endif %}><a href="#{{ tab_id }}" role="tab" aria-controls="{{ tab_id }}" data-toggle="tab">{{ mt_display_name }}</a></li>
                  {% endfor %}
                  </ul>
                  <div class="tab-content">
                  {% for body in method[1].bodies %}
                    {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                    {% assign hljs_lang = body[1].media_type | mediatype_highlight_lang  %}
                    {% assign tab_id =  method[1].method | append: '_' | append: resource.display_name | append: '_' | append: mt_display_name | slugify %}
                    <div role="tabpanel" class="tab-pane{% if forloop.first %} active{% endif %}" id="{{ tab_id }}">
                      <div class="content">
                      {% if hljs_lang == 'xml' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                      {% elsif hljs_lang == 'html' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                      {% elsif hljs_lang == 'json' %}
                        <h3>Example</h3>
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example }}</code></pre>
                      {% endif %}
                      </div>
                    </div>
                  {% endfor %}
                  </div>
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- Response
                --
                ----------------------------------------
                {% endcomment %}
                <h3>Response</h3>
                {% for response in method[1].responses %}
                  <h4>{{ response[1].display_name }} ({{ response[1].status_code }})</h4>
                  {% if response[1].description %}
                    {{ response[1].description | markdownify }}
                  {% endif %}
                  {% comment %}

                  Tabs for JSON, XML, SOAP

                  {% endcomment %}
                  {% if response[1].bodies.size > 0 %}
                    <ul class="tabs" role="tablist">
                    {% for body in response[1].bodies %}
                      {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                      {% assign tab_id =  method[1].method | append: '_' | append: resource.display_name | append: '_' | append: mt_display_name | append: '-response' | slugify %}
                      <li role="presentation"{% if forloop.first %} class="active"{% endif %}><a href="#{{ tab_id }}" role="tab" aria-controls="{{ tab_id }}" data-toggle="tab">{{ mt_display_name }}</a></li>
                    {% endfor %}
                    </ul>
                    <div class="tab-content">
                    {% for body in response[1].bodies %}
                      {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                      {% assign hljs_lang = body[1].media_type | mediatype_highlight_lang  %}
                      {% assign tab_id =  method[1].method | append: '_' | append: resource.display_name | append: '_' | append: mt_display_name | append: '-response' | slugify %}
                      <div role="tabpanel" class="tab-pane{% if forloop.first %} active{% endif %}" id="{{ tab_id }}">
                        {% if hljs_lang == 'xml' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                        {% elsif hljs_lang == 'html' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                        {% else %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example }}</code></pre>
                        {% endif %}
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endfor %}

              </section>
              {% endfor %}{% comment %} endfor method in methods {% endcomment %}
            {% endfor %}{% comment %} endfor resource in resources {% endcomment %}
          </div>
          <div class="col-1-4">
            <nav>
              <ul class="nav nav-tabs">
              {% for api_page in site.pages %}
                {% unless api_page.api %}{% continue %}{% endunless %}
                <li>
                  <a href="{{ api_page.url }}">{{ api_page.api.title }}</a>
                  <ul>
                    <li><a href="{{ api_page.url }}#api-documentation"><span data-hover="Documentation">Documentation</span></a></li>
                    {% for resource in api_page.api.resources %}
                      <li><a href="{{ api_page.url }}#{{ resource.display_name | slugify }}"><span data-hover="{{ resource.display_name }}">{{ resource.display_name }}</span></a></li>
                    {% endfor %}
                  </ul>
                </li>
              {% endfor %}
              </ul>
            </nav>
          </div> <!-- /sidebar column -->
        </div> <!-- /gridline -->
      </div> <!-- /outer-most container -->
    </div> <!-- /page-content-container -->
  </div> <!-- /page-body -->

</article>
<script async src="{{ site.baseurl }}/js/ZeroClipboard.min.js" onload="initZeroClipBoard()"></script>
<script>
  function initZeroClipBoard() {
    $('pre.highlight').before('<div class="zero-clipboard"><span class="btn-clipboard" title="Copy to clipboard">Copy</span></div>');
    var client = new ZeroClipboard($('.btn-clipboard'));
    client.on('copy', function(event) {
      var el = $(event.target).parent().nextAll('pre').first();
      client.setText(el.text());
    });
  }
</script>


