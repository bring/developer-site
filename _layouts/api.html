---
layout: redesign
---
<article class="api {{ page.api.title | remove:'API' | slugify }}">

      <div class="wrapperx">
        <div class="layout layout--large layout--rev">
          <div class="layout__item u-3/4">
            <section id="api-documentation">
            <h1>{{ page.api.title }}</h1>
              {% for chapter in page.api.documentation %}
              <h2 class="anchored">{{ chapter.title }}</h2>
              {{ chapter.content | markdownify }}
              {% endfor %}
            </section>
            <section>
              <h2 class="anchored">Overview of endpoints</h2>

              <h3>Base URL</h3>
              <pre>{{ page.api.base_uri }}</pre>

              <table class="linked-rows">
                <thead>
                  <th>Method</th>
                  <th>Endpoint</th>
                  <th>Usage</th>
                </thead>
                {% for resource in page.api.resources %}
                  {% for method in resource.methods %}
                    <tr>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ method[1].method }}</a></td>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ resource.relative_uri }}</a></td>
                      <td><a href="#{{ resource.display_name | slugify }}">{{ method[1].description }}</a></td>
                    </tr>
                  {% endfor %}
                {% endfor %}
              </table>
            </section>


            {% for resource in page.api.resources %}
              {% for method in resource.methods %}
              <section class="component {% cycle 'white', 'lightgrey' %}">

                <h1 class="large anchored" id="{{ resource.display_name | slugify }}">{{ resource.display_name }}</h1>

                {% if resource.description %}
                {{ resource.description | markdownify }}
                {% endif %}

                <h2>URL</h2>
                {% if resource.uri_parameters contains 'mediaTypeExtension' %}
                  {% assign url_output = '' %}
                  {% for extension in resource.uri_parameters.mediaTypeExtension.enum %}
                    {% assign url_output = url_output | append: resource.absolute_uri | replace:'{mediaTypeExtension}',extension %}
                    {% unless forloop.last %}
                      {% assign url_output = url_output | append: '<br />' %}
                    {% endunless %}
                  {% endfor %}
                {% else %}
                  {% assign url_output = resource.absolute_uri %}
                {% endif %}
                <pre>{{ url_output }}</pre>

                {% assign has_other_uri_params_than_mediatype = false %}
                {% if resource.uri_parameters.size > 1 %}
                  {% assign has_other_uri_params_than_mediatype = true %}
                {% elsif resource.uri_parameters.size == 1 and resource.uri_parameters.first[1].name != 'mediaTypeExtension' %}
                  {% assign has_other_uri_params_than_mediatype = true %}
                {% endif %}
                
                {% if has_other_uri_params_than_mediatype
                    or method[1].headers.size > 0 
                    or method[1].query_parameters.size > 0 %}
                <h2>Request params</h2>
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all URI parameters
                --
                ----------------------------------------
                {% endcomment %}
                {% if has_other_uri_params_than_mediatype %}
                  {% assign include_params = resource.uri_parameters %}
                  {% include named_params.html title="URI parameter" params=include_params %}
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all headers
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].headers.size > 0 %}
                  {% assign include_params = method[1].headers %}
                  {% include named_params.html title="Header name" params=include_params %}
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- List all query parameters
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].query_parameters.size > 0 %}
                  {% assign include_params = method[1].query_parameters %}
                  {% include named_params.html title="Query parameter" params=include_params %}
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- Request
                --
                ----------------------------------------
                {% endcomment %}
                {% if method[1].bodies.size > 0 %}
                  <h2>Request body</h2>
                  {% comment %}

                  Tabs for JSON, XML, SOAP

                  {% endcomment %}
                  <ul class="tabs" role="tablist">
                  {% for body in method[1].bodies %}
                    {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                    {% assign tab_id =  method[1].method | append: '-' | append: resource.display_name | append: '-request-' | append: forloop.index | slugify %}
                    <li role="presentation"{% if forloop.first %} class="active"{% endif %}><a href="#{{ tab_id }}" role="tab" aria-controls="{{ tab_id }}" data-toggle="tab">{{ mt_display_name }}</a></li>
                  {% endfor %}
                  </ul>
                  <div class="tab-content">
                  {% for body in method[1].bodies %}
                    {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                    {% assign hljs_lang = body[1].media_type | mediatype_highlight_lang  %}
                    {% assign tab_id =  method[1].method | append: '-' | append: resource.display_name | append: '-request-' | append: forloop.index | slugify %}
                    <div role="tabpanel" class="tab-pane{% if forloop.first %} active{% endif %}" id="{{ tab_id }}">
                      <div class="content">
                      {% if hljs_lang == 'xml' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                      {% elsif hljs_lang == 'html' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                      {% elsif hljs_lang == 'json' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example }}</code></pre>
                      {% endif %}
                      </div>
                    </div>
                  {% endfor %}
                  </div>
                {% endif %}

                {% comment %}
                ----------------------------------------
                --
                -- For each endpoint:
                -- Response
                --
                ----------------------------------------
                {% endcomment %}
                {% unless method[1].responses == empty %}
                <h2>Response</h2>
                {% endunless %}
                {% for response in method[1].responses %}
                  <h3>{{ response[1].display_name }} ({{ response[1].status_code }})</h3>
                  {% if response[1].description %}
                    {{ response[1].description | markdownify }}
                  {% endif %}

                  {% comment %}
                  ----------------------------------------
                  --
                  -- For each endpoint:
                  -- List all headers
                  --
                  ----------------------------------------
                  {% endcomment %}
                  {% if response[1].headers.size > 0 %}
                    {% assign include_params = response[1].headers %}
                    {% include named_params.html title="Header name" params=include_params hide_required=true %}
                  {% endif %}

                  {% comment %}

                  Tabs for JSON, XML, SOAP

                  {% endcomment %}
                  {% if response[1].bodies.size > 0 %}
                    <ul class="tabs" role="tablist">
                    {% for body in response[1].bodies %}
                      {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                      {% assign tab_id =  method[1].method | append: '-' | append: resource.display_name | append: '-response-' | append: forloop.index | slugify %}
                      <li role="presentation" class="tabs__item{% if forloop.first %} active{% endif %}"><a href="#{{ tab_id }}" role="tab" aria-controls="{{ tab_id }}" class="tabs__link" data-toggle="tab">{{ mt_display_name }}</a></li>
                    {% endfor %}
                    </ul>
                    <div class="tab-content">
                    {% for body in response[1].bodies %}
                      {% assign mt_display_name = body[1].media_type | mediatype_displayname %}
                      {% assign hljs_lang = body[1].media_type | mediatype_highlight_lang  %}
                      {% assign tab_id =  method[1].method | append: '-' | append: resource.display_name | append: '-response-' | append: forloop.index | slugify %}
                      <div role="tabpanel" class="tab-pane{% if forloop.first %} active{% endif %}" id="{{ tab_id }}">
                        {% if hljs_lang == 'xml' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                        {% elsif hljs_lang == 'html' %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example | xml_escape}}</code></pre>
                        {% else %}
                        <pre class="highlight"><code class="{{ hljs_lang }}">{{ body[1].example }}</code></pre>
                        {% endif %}
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endfor %}

              </section>
              {% endfor %}{% comment %} endfor method in methods {% endcomment %}
            {% endfor %}{% comment %} endfor resource in resources {% endcomment %}
          </div><!-- 
          --><div class="layout__item u-1/4">
            {% comment %}
            ----------------------------------------
            --
            -- Sidebar menu
            --
            ----------------------------------------
            {% endcomment %}
            <nav class="apimenu">
              <ul class="apimenu__list">
              {% for api_page in site.pages %}
                {% unless api_page.api %}{% continue %}{% endunless %}
                <li class="apimenu__item">
                  <h3 class="epsilon u-mb0"><a href="{{ site.baseurl }}{{ api_page.url }}">{{ api_page.api.title }}</a></h3>
                  <ul class="apimenu__sublist">
                    <li><a href="{{ site.baseurl }}{{ api_page.url }}#api-documentation"><span data-hover="Documentation">Documentation</span></a></li>
                    {% for resource in api_page.api.resources %}
                      <li><a href="{{ site.baseurl }}{{ api_page.url }}#{{ resource.display_name | slugify }}"><span data-hover="{{ resource.display_name }}">{{ resource.display_name }}</span></a></li>
                    {% endfor %}
                  </ul>
                </li>
              {% endfor %}
              </ul>
            </nav>
          </div>
        </div>
      </div>

</article>
<script async src="{{ site.baseurl }}/js/ZeroClipboard.min.js" onload="initZeroClipBoard()"></script>
<script>
  function initZeroClipBoard() {
    $('pre.highlight').before('<div class="zero-clipboard"><span class="btn-clipboard" title="Copy to clipboard">Copy</span></div>');
    var client = new ZeroClipboard($('.btn-clipboard'));
    client.on('copy', function(event) {
      var el = $(event.target).parent().nextAll('pre').first();
      client.setText(el.text());
    });
  }
</script>


